--- brctl/brctld.c.orig	Fri Dec  7 15:23:31 2001
+++ brctl/brctld.c	Mon Mar  3 11:03:01 2003
@@ -161,6 +161,11 @@
 	int sock;
 	int x;
 
+        if (getuid() != 0) {
+                fprintf(stderr, "must be run as root...\n");
+                return 1;
+        }
+
 	if ((sock = socket(AF_INET, SOCK_STREAM, 0)) < 0) {
 		perror("socket");
 		return 1;
